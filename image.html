<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title></title>
  <style media="screen">
    body {
      background: black;
      text-align: center;
    }

    #c1 {
      background-image: url(./backgroud.png);
      background-repeat: repeat;
      background-attachment: scroll;
    }
  </style>
  <script>
    window.onload = function() {
      let keys = {
        38: 'u',
        40: 'd',
        37: 'l',
        39: 'r',
      };
      let rows = {
        'u': 3,
        'd': 0,
        'l': 1,
        'r': 2,
      }
      let oCanvas = document.getElementById('c1');
      let brush = oCanvas.getContext('2d');
      let oImage = new Image();
      const speed = 5;
      let x = 100;
      let y = 100;
      oImage.src = 'rpg.jpg';
      oImage.onload = function() {
        let frame = 0;
        let dir = 'r';
        setInterval(function() {
          document.onkeydown = function(ev) {
            dir = keys[ev.keyCode];
            console.log(dir);
          };
          brush.clearRect(0, 0, oCanvas.width, oCanvas.height);
          brush.drawImage(oImage, 97 + (frame * 32), 32 * rows[dir], 32, 32, x, y, 74, 98);
          frame++;
          if (frame == 3) {
            frame = 0;
          }
          switch (dir) {
            case 'u':
              y -= speed;
              if (y < -30) y = oCanvas.height;
              console.log('y-->' + y);
              break;
            case 'd':
              y += speed;
              if (y > oCanvas.height) y = -30;
              console.log('y-->' + y);
              break;
            case 'l':
              x -= speed;
              if (x < -30) x = oCanvas.width;
              console.log('x-->' + x);
              break;
            case 'r':
              x += speed;
              if (x > oCanvas.width) x = -30;
              console.log('x-->' + x);
              break;
          }
        }, 100);
      };
    };
  </script>
</head>

<body>
  <canvas id="c1" width="800" height="600"></canvas>
</body>

</html>
